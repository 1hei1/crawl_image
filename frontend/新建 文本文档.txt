æˆ‘æ¥ä¸ºæ‚¨åˆ—å‡ºimage_crawleræ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„è¯¦ç»†ç»“æ„ã€‚è®©æˆ‘å…ˆæŸ¥çœ‹æ•°æ®åº“æ¨¡å‹å®šä¹‰å’Œè¿ç§»æ–‡ä»¶æ¥è·å–å®Œæ•´çš„è¡¨ç»“æ„ä¿¡æ¯ã€‚

Augment Context Engine
æ•°æ®åº“è¡¨ç»“æ„å®šä¹‰ï¼ŒåŒ…æ‹¬æ‰€æœ‰å­—æ®µã€æ•°æ®ç±»å‹ã€çº¦æŸã€ç´¢å¼•ã€å¤–é”®å…³ç³»çš„å®Œæ•´ä¿¡æ¯
ç°åœ¨è®©æˆ‘æŸ¥çœ‹æ›´å¤šå…³äºè¡¨ç»“æ„çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç´¢å¼•å’Œçº¦æŸï¼š

Read directory
migrations
database
Read file
001_initial_schema.py
database/migrations
ğŸ“Š image_crawler æ•°æ®åº“æ‰€æœ‰è¡¨ç»“æ„
åŸºäºä»£ç åˆ†æï¼Œä»¥ä¸‹æ˜¯ image_crawler æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„å®Œæ•´ç»“æ„ï¼š

ğŸ—‚ï¸ 1. categoriesï¼ˆåˆ†ç±»è¡¨ï¼‰
å­—æ®µå	æ•°æ®ç±»å‹	çº¦æŸ	é»˜è®¤å€¼	è¯´æ˜
id	INTEGER	PRIMARY KEY, AUTO_INCREMENT	-	ä¸»é”®ID
created_at	DATETIME(timezone=True)	NOT NULL	now()	åˆ›å»ºæ—¶é—´
updated_at	DATETIME(timezone=True)	NOT NULL	now()	æ›´æ–°æ—¶é—´
status	VARCHAR(20)	NOT NULL	'active'	çŠ¶æ€ï¼šactive/inactive/deleted
name	VARCHAR(100)	NOT NULL, UNIQUE	-	åˆ†ç±»åç§°
slug	VARCHAR(100)	NOT NULL, UNIQUE	-	åˆ†ç±»æ ‡è¯†ç¬¦
description	TEXT	NULL	-	åˆ†ç±»æè¿°
parent_id	INTEGER	NULL, FK(categories.id)	-	çˆ¶åˆ†ç±»ID
level	INTEGER	NULL	0	åˆ†ç±»å±‚çº§ï¼ˆ0ä¸ºé¡¶çº§ï¼‰
sort_order	INTEGER	NULL	0	æ’åºé¡ºåº
auto_rules	TEXT	NULL	-	è‡ªåŠ¨åˆ†ç±»è§„åˆ™ï¼ˆJSONæ ¼å¼ï¼‰
keywords	TEXT	NULL	-	å…³é”®è¯åˆ—è¡¨ï¼ˆJSONæ ¼å¼ï¼‰
image_count	INTEGER	NULL	0	åŒ…å«å›¾ç‰‡æ•°é‡
total_size	INTEGER	NULL	0	æ€»æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
color	VARCHAR(7)	NULL	-	åˆ†ç±»é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰
icon	VARCHAR(50)	NULL	-	åˆ†ç±»å›¾æ ‡
is_visible	VARCHAR(10)	NULL	'true'	æ˜¯å¦å¯è§
ç´¢å¼•ï¼š

idx_categories_parent_id ON (parent_id)
å¤–é”®çº¦æŸï¼š

parent_id â†’ categories.id
ğŸ–¼ï¸ 2. imagesï¼ˆå›¾ç‰‡è¡¨ï¼‰
å­—æ®µå	æ•°æ®ç±»å‹	çº¦æŸ	é»˜è®¤å€¼	è¯´æ˜
id	INTEGER	PRIMARY KEY, AUTO_INCREMENT	-	ä¸»é”®ID
created_at	DATETIME(timezone=True)	NOT NULL	now()	åˆ›å»ºæ—¶é—´
updated_at	DATETIME(timezone=True)	NOT NULL	now()	æ›´æ–°æ—¶é—´
status	VARCHAR(20)	NOT NULL	'active'	çŠ¶æ€ï¼šactive/inactive/deleted
url	VARCHAR(2048)	NOT NULL	-	å›¾ç‰‡åŸå§‹URL
source_url	VARCHAR(2048)	NOT NULL	-	å›¾ç‰‡æ¥æºé¡µé¢URL
filename	VARCHAR(255)	NOT NULL	-	æ–‡ä»¶å
original_filename	VARCHAR(255)	NULL	-	åŸå§‹æ–‡ä»¶å
file_extension	VARCHAR(10)	NOT NULL	-	æ–‡ä»¶æ‰©å±•å
mime_type	VARCHAR(50)	NULL	-	MIMEç±»å‹
file_size	INTEGER	NULL	-	æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
width	INTEGER	NULL	-	å›¾ç‰‡å®½åº¦ï¼ˆåƒç´ ï¼‰
height	INTEGER	NULL	-	å›¾ç‰‡é«˜åº¦ï¼ˆåƒç´ ï¼‰
aspect_ratio	FLOAT	NULL	-	å®½é«˜æ¯”
color_mode	VARCHAR(20)	NULL	-	é¢œè‰²æ¨¡å¼ï¼ˆRGBã€RGBAã€Lç­‰ï¼‰
has_transparency	BOOLEAN	NULL	FALSE	æ˜¯å¦æœ‰é€æ˜é€šé“
md5_hash	VARCHAR(32)	UNIQUE	-	MD5å“ˆå¸Œå€¼
sha256_hash	VARCHAR(64)	NULL	-	SHA256å“ˆå¸Œå€¼
perceptual_hash	VARCHAR(64)	NULL	-	æ„ŸçŸ¥å“ˆå¸Œå€¼ï¼ˆç”¨äºç›¸ä¼¼å›¾ç‰‡æ£€æµ‹ï¼‰
category_id	INTEGER	NULL, FK(categories.id)	-	åˆ†ç±»ID
tags	TEXT	NULL	-	æ ‡ç­¾ï¼ˆJSONæ ¼å¼å­˜å‚¨ï¼‰
auto_tags	TEXT	NULL	-	è‡ªåŠ¨ç”Ÿæˆçš„æ ‡ç­¾
local_path	VARCHAR(512)	NULL	-	æœ¬åœ°å­˜å‚¨è·¯å¾„
is_downloaded	BOOLEAN	NULL	FALSE	æ˜¯å¦å·²ä¸‹è½½
download_attempts	INTEGER	NULL	0	ä¸‹è½½å°è¯•æ¬¡æ•°
last_download_error	TEXT	NULL	-	æœ€åä¸€æ¬¡ä¸‹è½½é”™è¯¯ä¿¡æ¯
quality_score	FLOAT	NULL	-	å›¾ç‰‡è´¨é‡è¯„åˆ†ï¼ˆ0-1ï¼‰
is_duplicate	BOOLEAN	NULL	FALSE	æ˜¯å¦ä¸ºé‡å¤å›¾ç‰‡
duplicate_of	INTEGER	NULL, FK(images.id)	-	é‡å¤çš„åŸå›¾ID
exif_data	TEXT	NULL	-	EXIFæ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰
alt_text	TEXT	NULL	-	å›¾ç‰‡altæ–‡æœ¬
title	VARCHAR(255)	NULL	-	å›¾ç‰‡æ ‡é¢˜
description	TEXT	NULL	-	å›¾ç‰‡æè¿°
ç´¢å¼•ï¼š

idx_images_url ON (url)
idx_images_source_url ON (source_url)
idx_images_filename ON (filename)
idx_images_category_id ON (category_id)
idx_images_is_downloaded ON (is_downloaded)
idx_images_created_at ON (created_at)
å¤–é”®çº¦æŸï¼š

category_id â†’ categories.id
duplicate_of â†’ images.id
ğŸ·ï¸ 3. tagsï¼ˆæ ‡ç­¾è¡¨ï¼‰
å­—æ®µå	æ•°æ®ç±»å‹	çº¦æŸ	é»˜è®¤å€¼	è¯´æ˜
id	INTEGER	PRIMARY KEY, AUTO_INCREMENT	-	ä¸»é”®ID
created_at	DATETIME(timezone=True)	NOT NULL	now()	åˆ›å»ºæ—¶é—´
updated_at	DATETIME(timezone=True)	NOT NULL	now()	æ›´æ–°æ—¶é—´
status	VARCHAR(20)	NOT NULL	'active'	çŠ¶æ€ï¼šactive/inactive/deleted
name	VARCHAR(255)	NOT NULL, UNIQUE	-	æ ‡ç­¾åç§°
slug	VARCHAR(255)	NOT NULL, UNIQUE	-	æ ‡ç­¾æ ‡è¯†ç¬¦
description	TEXT	NULL	-	æ ‡ç­¾æè¿°
group_name	VARCHAR(255)	NULL	-	æ ‡ç­¾åˆ†ç»„
tag_type	VARCHAR(255)	NULL	'manual'	æ ‡ç­¾ç±»å‹ï¼šmanual-æ‰‹åŠ¨ï¼Œauto-è‡ªåŠ¨
usage_count	INTEGER	NULL	0	ä½¿ç”¨æ¬¡æ•°
color	VARCHAR(255)	NULL	-	æ ‡ç­¾é¢œè‰²
å”¯ä¸€çº¦æŸï¼š

UNIQUE(name)
UNIQUE(slug)
ğŸ“‹ 4. crawl_sessionsï¼ˆçˆ¬å–ä¼šè¯è¡¨ï¼‰
å­—æ®µå	æ•°æ®ç±»å‹	çº¦æŸ	é»˜è®¤å€¼	è¯´æ˜
id	INTEGER	PRIMARY KEY, AUTO_INCREMENT	-	ä¸»é”®ID
created_at	DATETIME(timezone=True)	NOT NULL	now()	åˆ›å»ºæ—¶é—´
updated_at	DATETIME(timezone=True)	NOT NULL	now()	æ›´æ–°æ—¶é—´
status	VARCHAR(20)	NOT NULL	'pending'	æ‰§è¡ŒçŠ¶æ€ï¼špending/running/completed/failed/cancelled
session_name	VARCHAR(100)	NULL	-	ä¼šè¯åç§°
target_url	VARCHAR(2048)	NOT NULL	-	ç›®æ ‡ç½‘ç«™URL
session_type	VARCHAR(20)	NULL	'manual'	ä¼šè¯ç±»å‹ï¼šmanual-æ‰‹åŠ¨ï¼Œscheduled-å®šæ—¶
config_data	JSON	NULL	-	çˆ¬å–é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰
max_depth	INTEGER	NULL	3	æœ€å¤§çˆ¬å–æ·±åº¦
max_images	INTEGER	NULL	-	æœ€å¤§å›¾ç‰‡æ•°é‡é™åˆ¶
allowed_domains	TEXT	NULL	-	å…è®¸çš„åŸŸååˆ—è¡¨
image_filters	JSON	NULL	-	å›¾ç‰‡è¿‡æ»¤è§„åˆ™
start_time	DATETIME(timezone=True)	NULL	-	å¼€å§‹æ—¶é—´
end_time	DATETIME(timezone=True)	NULL	-	ç»“æŸæ—¶é—´
duration_seconds	FLOAT	NULL	-	æ‰§è¡Œæ—¶é•¿ï¼ˆç§’ï¼‰
total_pages	INTEGER	NULL	0	æ€»é¡µé¢æ•°
processed_pages	INTEGER	NULL	0	å·²å¤„ç†é¡µé¢æ•°
total_images_found	INTEGER	NULL	0	å‘ç°çš„å›¾ç‰‡æ€»æ•°
images_downloaded	INTEGER	NULL	0	æˆåŠŸä¸‹è½½çš„å›¾ç‰‡æ•°
images_failed	INTEGER	NULL	0	ä¸‹è½½å¤±è´¥çš„å›¾ç‰‡æ•°
images_skipped	INTEGER	NULL	0	è·³è¿‡çš„å›¾ç‰‡æ•°
total_size_bytes	INTEGER	NULL	0	ä¸‹è½½æ€»å¤§å°ï¼ˆå­—èŠ‚ï¼‰
average_image_size	FLOAT	NULL	-	å¹³å‡å›¾ç‰‡å¤§å°ï¼ˆå­—èŠ‚ï¼‰
download_speed_mbps	FLOAT	NULL	-	å¹³å‡ä¸‹è½½é€Ÿåº¦ï¼ˆMB/sï¼‰
high_quality_count	INTEGER	NULL	0	é«˜è´¨é‡å›¾ç‰‡æ•°é‡
duplicate_count	INTEGER	NULL	0	é‡å¤å›¾ç‰‡æ•°é‡
error_count	INTEGER	NULL	0	é”™è¯¯æ•°é‡
last_error	TEXT	NULL	-	æœ€åä¸€ä¸ªé”™è¯¯ä¿¡æ¯
error_log	TEXT	NULL	-	é”™è¯¯æ—¥å¿—
summary_log	TEXT	NULL	-	æ‰§è¡Œæ‘˜è¦
peak_memory_mb	FLOAT	NULL	-	å³°å€¼å†…å­˜ä½¿ç”¨ï¼ˆMBï¼‰
cpu_usage_percent	FLOAT	NULL	-	CPUä½¿ç”¨ç‡ï¼ˆ%ï¼‰
ç´¢å¼•ï¼š

idx_crawl_sessions_target_url ON (target_url)
idx_crawl_sessions_status ON (status)
ğŸ”— è¡¨å…³ç³»æ€»ç»“
categories â†” categoriesï¼šè‡ªå¼•ç”¨å…³ç³»ï¼ˆparent_id â†’ idï¼‰
images â†’ categoriesï¼šå¤šå¯¹ä¸€å…³ç³»ï¼ˆcategory_id â†’ categories.idï¼‰
images â†” imagesï¼šè‡ªå¼•ç”¨å…³ç³»ï¼ˆduplicate_of â†’ idï¼‰
crawl_sessions â†’ imagesï¼šä¸€å¯¹å¤šå…³ç³»ï¼ˆé€šè¿‡ä¸šåŠ¡é€»è¾‘å…³è”ï¼‰
images â†” tagsï¼šå¤šå¯¹å¤šå…³ç³»ï¼ˆé€šè¿‡JSONå­—æ®µå­˜å‚¨ï¼‰
ğŸ“ˆ æ•°æ®åº“ç‰¹æ€§
æ”¯æŒæ—¶åŒºçš„æ—¶é—´æˆ³ï¼šæ‰€æœ‰æ—¶é—´å­—æ®µéƒ½ä½¿ç”¨ DATETIME(timezone=True)
è½¯åˆ é™¤æœºåˆ¶ï¼šé€šè¿‡ status å­—æ®µå®ç°
JSONæ•°æ®æ”¯æŒï¼šé…ç½®å’Œæ ‡ç­¾ä½¿ç”¨JSONæ ¼å¼å­˜å‚¨
å®Œæ•´æ€§çº¦æŸï¼šå¤–é”®çº¦æŸç¡®ä¿æ•°æ®ä¸€è‡´æ€§
æ€§èƒ½ä¼˜åŒ–ï¼šå…³é”®å­—æ®µå»ºç«‹ç´¢å¼•
å»é‡æœºåˆ¶ï¼šMD5å“ˆå¸Œå€¼å”¯ä¸€çº¦æŸé˜²æ­¢é‡å¤å›¾ç‰‡
è¿™ä¸ªæ•°æ®åº“è®¾è®¡æ”¯æŒå®Œæ•´çš„å›¾ç‰‡çˆ¬è™«åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ†å±‚åˆ†ç±»ã€æ ‡ç­¾ç®¡ç†ã€é‡å¤æ£€æµ‹ã€ä¼šè¯è·Ÿè¸ªå’Œæ€§èƒ½ç›‘æ§ã€‚